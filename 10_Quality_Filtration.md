# Running Variant Filtration on VCF Files Generated by GATK

VariantFiltration is used to apply quality filters to VCF files produced by GATK HaplotypeCaller, helping to remove low-confidence variant calls. Variants are filtered based on quality metrics such as QD, FS, and MQ.

## Command to Filter Multiple VCF Files

Run the following loop to apply common filtering expressions (QD, FS, MQ) to all `.vcf.gz` files:

```
for vcf in *.vcf.gz; do
    sample_name=$(basename "$vcf" .vcf.gz)
    gatk VariantFiltration \
        -R reference.fasta \
        -V "$vcf" \
        -O "${sample_name}_filtered.vcf.gz" \
        --filter-name "QD_filter" --filter-expression "QD < 2.0" \
        --filter-name "FS_filter" --filter-expression "FS > 60.0" \
        --filter-name "MQ_filter" --filter-expression "MQ < 40.0"
done
```

> Adjust thresholds as needed based on your project or species-specific quality metrics.


